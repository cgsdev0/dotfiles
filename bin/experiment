#!/bin/bash

while read -r session client; do
  session=${session}:0.0
  DIMENSIONS="$(tmux -L outer display -t $session -p "#{pane_width}x#{pane_height}")"
  # POSITION="$(tmux -L outer display -c $client -p "#{pane_left}x#{pane_top}")"
  HEIGHT="${DIMENSIONS#*x}"
  WIDTH="${DIMENSIONS%x*}"
  # Y="${POSITION#*x}"
  # ((Y+=HEIGHT+1))
  # X="${POSITION%x*}"
  STUFF="$(tmux -L outer capture-pane -t $session -p -e)"
  echo -e "$STUFF" \
    | popup -c $client -e $1 -B -E -x 0 -y 0 -w $WIDTH -h $HEIGHT &
    # | popup -c $client -e $1 -E -B -y$Y -x$X -w $WIDTH -h $HEIGHT &
done < <(tmux -L outer list-clients -F '#{session_name} #{client_name}')
wait

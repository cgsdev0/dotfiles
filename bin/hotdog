#!/usr/bin/env bash

TERMINAL_CONF="C:/Users/sarah/AppData/Local/Packages/Microsoft.WindowsTerminal_8wekyb3d8bbwe/LocalState/settings.json"

vim_cmd() {
  find /run/user/1000/ -iname 'nvim*' 2> /dev/null \
  | xargs -I {} nvim --server {} --remote-send "$1" &
}

save_theme() {
  echo "$1" > ~/.theme
}

daydog() {
  THEME=tokyonight-day
  ssh sarah@192.168.0.206 "powershell.exe Set-Content -Path ${TERMINAL_CONF} -Value ( (Get-Content -Path ${TERMINAL_CONF} -Raw) -Replace '\\\"colorScheme\\\": \\\"tokyonight-storm\\\"','\\\"colorScheme\\\": \\\"tokyonight-day\\\"')"
  vim_cmd '<Esc>:colorscheme tokyonight-day<CR>'
  save_theme "$THEME"
}

hotdog() {
  ssh sarah@192.168.0.206 "powershell.exe Set-Content -Path ${TERMINAL_CONF} -Value ( (Get-Content -Path ${TERMINAL_CONF} -Raw) -Replace '\\\"colorScheme\\\": \\\"tokyonight-storm\\\"','\\\"colorScheme\\\": \\\"Hotdog\\\"')"
  vim_cmd '<Esc>:colorscheme hotdog<CR>'
}

nightdog() {
  THEME=tokyonight-storm
  ssh sarah@192.168.0.206 "powershell.exe Set-Content -Path ${TERMINAL_CONF} -Value ( (Get-Content -Path ${TERMINAL_CONF} -Raw) -Replace '\\\"colorScheme\\\": \\\"tokyonight-day\\\"','\\\"colorScheme\\\": \\\"tokyonight-storm\\\"')";
  vim_cmd '<Esc>:colorscheme tokyonight-storm<CR>'
  save_theme "$THEME"
}

not_hotdog() {
  THEME="$(cat ~/.theme)"
  ssh sarah@192.168.0.206 "powershell.exe Set-Content -Path ${TERMINAL_CONF} -Value ( (Get-Content -Path ${TERMINAL_CONF} -Raw) -Replace '\\\"colorScheme\\\": \\\"Hotdog\\\"','\\\"colorScheme\\\": \\\"$THEME\\\"')";
  vim_cmd '<Esc>:colorscheme '$THEME'<CR>'
}

if [[ "$1" == "pane" ]]; then
  cat ~/themes/override/hotdog
elif [[ "$1" == "reset" ]]; then
  cat ~/themes/override/reset
elif [[ "$1" == "not" ]]; then
  not_hotdog &> /dev/null
elif [[ "$1" == "night" ]]; then
  nightdog &> /dev/null
elif [[ "$1" == "day" ]]; then
  daydog &> /dev/null
else
  hotdog &> /dev/null
fi
